<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="author" content="__MyCompanyName__">
	<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
	<script type="text/javascript" src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>
	<script>

	var lang = "cs";
	var fail_message = "<p class='red'>Ověřovací kód je chybný, zkuste prosím zadat znovu!</p>";
	var theme = "white";
	
	function createRecaptcha(element)
	{
		Recaptcha.destroy();
		Recaptcha.create("6LdWCeQSAAAAAM2uFmpEIVo1ob2yVh7JrT1_PNTw",element,{
			theme:theme,callback:Recaptcha.focus_response_field
		});
	}
	
	function isValidEmail(email) {
		
		var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
		if (!filter.test(email)){
			showErrors();
			return false;
		} 
		else
		{
			return true;	
		}
	}
	function isValidContactForm(e,field) {
		
		var email = $(e.target).find(field).val();
		if (isValidEmail(email)) {
			return true;
		};
	}

	function showErrors() {
		if (lang == 'cs'){
			var msg = 'Vaše emailová adresa je chybná';
		} else {
			var msg = 'Please provide a valid email address';
		}
		alert(msg);
		return false;
	}

	function isCaptchaCorect(msgbox) {
		var chal=Recaptcha.get_challenge();
		var resp=Recaptcha.get_response();
		var html=$.ajax({
			type:"POST",url:"http://captcha.blueberry.cz/validateform.php",data:"form=signup&recaptcha_challenge_field="+chal+"&recaptcha_response_field="+resp,async:false
			}).responseText;

			if(html=="success")
			{
				return true
			} else {
				$(msgbox).html(fail_message);
				Recaptcha.reload();
				return false
			}
		}

		$(document).ready(function() {

			createRecaptcha('recaptcha_right'); //DisplayCaptchaForm

			$(document).on('submit', '.valid-me', function(e) { //Sedn form with valid-me class

				if (isValidContactForm(e,"input#emailformpu")) { // If is valid contact form

					if (isCaptchaCorect("#recaptcha_result_right")) { // If captcha is corect
						return true;
					} else {
						return false;	
					}
				} else {
					return false;
				}
			});
		});

		</script>
	</head>

	<body>
		<form method="post" action="adsdasdfsa"  name="xxxx" class="valid-me">
			<input type="text" class="clearMeFocus" name="email" id="emailformpu" title="Emailová adresa" value="Emailová adresa"><br>
			<textarea name="message" class="clearMeFocus" title="Zpráva pro nás">Zpráva pro nás</textarea><br>
			<div id="recaptcha_right"></div>
			<input type="submit" value="Odeslat zprávu" >
		</form>

	
		<div id="recaptcha_result_right"></div>
	</body>

	</html>

